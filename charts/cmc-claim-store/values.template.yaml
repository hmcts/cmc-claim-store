postgresql:
  initdbScripts:
    init.sql: |-
      CREATE USER claimstore WITH PASSWORD 'claimstore';
      CREATE DATABASE claimstore WITH OWNER = claimstore ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
      CREATE USER cmc WITH PASSWORD 'cmc';
      CREATE DATABASE cmc WITH OWNER = cmc ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
  nameOverride: claim-store-postgres
  persistence:
    enabled: false

claim-store:
  image: ${IMAGE_NAME}
  ingressHost: ${SERVICE_FQDN}
  applicationPort: 4400
  cpuRequests: 25m
  environment:
    REFORM_TEAM: cmc
    REFORM_SERVICE_NAME: claim-store
    REFORM_ENVIRONMENT: preview
    LOG_LEVEL: DEBUG
    CLAIM_STORE_DB_HOST: ${SERVICE_NAME}-claim-store-postgres
    CLAIM_STORE_DB_PORT: 5432
    CLAIM_STORE_DB_USERNAME: claimstore
    CLAIM_STORE_DB_PASSWORD: claimstore
    CLAIM_STORE_DB_NAME: claimstore
    CMC_DB_HOST: ${SERVICE_NAME}-claim-store-postgres
    CMC_DB_PORT: 5432
    CMC_DB_USERNAME: cmc
    CMC_DB_PASSWORD: cmc
    CMC_DB_NAME: cmc
    IDAM_S2S_AUTH_TOTP_SECRET: ${CLAIM_STORE_S2S_SECRET}
    IDAM_CASEWORKER_ANONYMOUS_USERNAME: ${ANONYMOUS_CASEWORKER_USERNAME}
    IDAM_CASEWORKER_ANONYMOUS_PASSWORD: ${ANONYMOUS_CASEWORKER_PASSWORD}
    IDAM_CASEWORKER_SYSTEM_USERNAME: ${SYSTEM_UPDATE_USERNAME}
    IDAM_CASEWORKER_SYSTEM_PASSWORD: ${SYSTEM_UPDATE_PASSWORD}
    OAUTH2_CLIENT_SECRET: ${OAUTH2_CLIENT_SECRET}
    GOV_NOTIFY_API_KEY: ${NOTIFY_API_KEY}
    SPRING_MAIL_HOST: mta.reform.hmcts.net
    SPRING_MAIL_PORT: 25
    SPRING_MAIL_TEST_CONNECTION: false
    SPRING_MAIL_PROPERTIES_MAIL_SMTP_STARTTLS_ENABLE: true
    SPRING_MAIL_PROPERTIES_MAIL_SMTP_SSL_TRUST: mta.reform.hmcts.net
    STAFF_NOTIFICATIONS_SENDER: noreply@reform.hmcts.net
    STAFF_NOTIFICATIONS_RECIPIENT: ${STAFF_EMAIL}
    RPA_NOTIFICATIONS_SENDER: noreply@reform.hmcts.net
    RPA_NOTIFICATIONS_SEALEDCLAIMRECIPIENT: ${STAFF_EMAIL}
    RPA_NOTIFICATIONS_MORETIMEREQUESTEDRECIPIENT: ${STAFF_EMAIL}
    RPA_NOTIFICATIONS_RESPONSERECIPIENT: ${STAFF_EMAIL}
    RPA_NOTIFICATIONS_COUNTYCOURTJUDGEMENTRECIPIENT: ${STAFF_EMAIL}
    CLAIM_STORE_TEST_SUPPORT_ENABLED: true
    FEATURE_TOGGLES_EMAILTOSTAFF: true
    FEATURE_TOGGLES_CCD_ENABLED: false
    FEATURE_TOGGLES_CCD_ASYNC_ENABLED: false
    APPINSIGHTS_INSTRUMENTATIONKEY: ${APPINSIGHTS_INSTRUMENTATIONKEY}
    DOCUMENT_MANAGEMENT_CASEWORKERROLE: caseworker-cmc
    CORE_CASE_DATA_API_URL: false
    SMOKE_TEST_CITIZEN_USERNAME: ${SMOKE_TEST_CITIZEN_USERNAME}
    SMOKE_TEST_SOLICITOR_USERNAME: ${SMOKE_TEST_SOLICITOR_USERNAME}
    SMOKE_TEST_USER_PASSWORD: ${SMOKE_TEST_USER_PASSWORD}
    GENERATED_USER_EMAIL_PATTERN: ${GENERATED_USER_EMAIL_PATTERN}
    FRONTEND_BASE_URL: https://www-${SERVICE_FQDN}
    RESPOND_TO_CLAIM_URL: https://www-${SERVICE_FQDN}/first-contact/start

rpe-feature-toggle-api:
  releaseNameOverride: ${SERVICE_NAME}-ftr-tgl-api
  registerDns: false
  importer:
    cron:
      enabled: false
    oneoff:
      command: /scripts/add-weighted-toggle.sh cmc_admissions 'CMC admissions' '1.0'
        admin@example.com Password12 && /scripts/add-toggle.sh cmc_defence_reminders
        'CMC defence reminders' false admin@example.com Password12
      enabled: true
      permissions: cmc-new-features-consent-given
  java:
    releaseNameOverride: ${SERVICE_NAME}-ftr-tgl-api
    environment:
      FEATURES_DB_HOST: ${SERVICE_NAME}-ft-db
      ADMIN_USERNAME_TEST: admin@example.com
      ADMIN_PASSWORD_TEST: Password12
      EDITOR_USERNAME_TEST: editor@example.com
      EDITOR_PASSWORD_TEST: Password12
  postgresql:
    postgresqlDatabase: hmcts

nodejs:
  ingressIP: ${INGRESS_IP}
  consulIP: ${CONSUL_LB_IP}
  releaseNameOverride: ${SERVICE_NAME}-nodejs
  registerAdditionalDns:
    enabled: true
    primaryIngressHost: ${SERVICE_FQDN}
    prefix: www
  image: hmcts/cmc-citizen-frontend:latest  # master
  applicationPort: 3000
  memoryRequests: 256Mi
  cpuRequests: 25m
  memoryLimits: 512Mi
  cpuLimits: 1
  environment:
    CLAIM_STORE_URL: http://${SERVICE_NAME}-claim-store
    REFORM_TEAM: cmc
    REFORM_SERVICE_NAME: citizen-frontend
    REFORM_ENVIRONMENT: preview
    NODE_ENV: production
    UV_THREADPOOL_SIZE: 64
    GA_TRACKING_ID: UA-97111056-1
    SERVICE_SURVEY_URL: http://www.smartsurvey.co.uk/s/CMCMVPT1/
    FEEDBACK_SURVEY_URL: http://www.smartsurvey.co.uk/s/CMCMVPFB/
    REPORT_PROBLEM_SURVEY_URL: http://www.smartsurvey.co.uk/s/CMCMVPPB/
    FEATURE_TOGGLES_API_URL: http://${SERVICE_NAME}-ftr-tgl-api:8580
    FEATURE_TESTING_SUPPORT: true
    FEATURE_NEW_FEATURES_CONSENT: true
    FEATURE_ADMISSIONS: true
    FEATURE_FINE_PRINT: true
    FEATURE_RETURN_ERROR_TO_USER: true
    FEATURE_MOCK_PAY: false
    POSTCODE_LOOKUP_API_KEY: ${POSTCODE_LOOKUP_API_KEY}
    APPINSIGHTS_INSTRUMENTATIONKEY: ${APPINSIGHTS_INSTRUMENTATIONKEY}
    OAUTH_CLIENT_SECRET: ${OAUTH_CLIENT_SECRET}
    IDAM_S2S_TOTP_SECRET: ${IDAM_S2S_TOTP_SECRET}
    DRAFT_STORE_SECRET_PRIMARY: ${DRAFT_STORE_SECRET_PRIMARY}
    DRAFT_STORE_SECRET_SECONDARY: ${DRAFT_STORE_SECRET_SECONDARY}
    COOKIE_ENCRYPTION_KEY: ${COOKIE_ENCRYPTION_KEY}
    CONTACT_EMAIL: ${CONTACT_EMAIL}
